<section class="font-rajdhani bg-[#0a0c10] min-h-screen py-10 px-8 text-secondary">
    <div
        class="flex flex-col gap-1.5 mb-8 relative pl-5 before:content-[''] before:absolute before:left-0 before:top-0 before:bottom-0 before:w-0.5 before:bg-linear-to-b before:from-purple-bright before:to-pink-bright before:rounded-sm"
    >
        <h1 class="text-[2rem] font-bold tracking-[0.12em] uppercase text-[#e8edf5] m-0 leading-none">
            USERS <span class="text-purple-brifrom-purple-bright">MGMT</span>
        </h1>
        <p class="text-[0.85rem] text-text-muted tracking-[0.05em] m-0 font-techmono">
            // kelola pengguna yang tersedia dalam sistem
        </p>
    </div>

    <% if (error) { %>
    <div
        class="py-3 px-5 rounded-sm text-[0.85rem] font-techmono tracking-[0.04em] mb-5 border-l-[3px] bg-[rgba(239,68,68,0.08)] border-l-red-bright text-[#fca5a5]"
    >
        ⚠
        <%= error %>
    </div>
    <% } %>
    <% if (success) { %>
    <div
        class="py-3 px-5 rounded-sm text-[0.85rem] font-techmono tracking-[0.04em] mb-5 border-l-[3px] bg-[rgba(167,139,250,0.08)] border-l-purple-bright text-[#c4b5fd]"
    >
        ✓
        <%= success %>
    </div>
    <% } %>

    <% if (editUser) { %>
    <div
        class="bg-[#0f1117] border border-border rounded px-6 py-6 mb-6 relative overflow-hidden after:content-[''] after:absolute after:top-0 after:left-0 after:right-0 after:h-0.5 after:bg-linear-to-r after:from-purple-bright after:via-pink-bright after:to-transparent"
    >
        <h2
            class="font-bold tracking-widest uppercase text-purple-brifrom-purple-bright m-0 mb-5 font-techmono text-[0.85rem]"
        >
            // EDIT_USER · ID #<%= editUser.id %>
        </h2>
        <form method="POST" action="/users/<%= editUser.id %>/update">
            <div class="grid grid-cols-2 gap-3 max-sm:grid-cols-1">
                <input
                    class="bg-[#141720] border border-border rounded-sm py-2.5 px-4 text-[#e8edf5] font-rajdhani text-[0.95rem] font-medium w-full outline-none transition-colors focus:border-purple-bright focus:shadow-[0_0_0_2px_rgba(167,139,250,0.08)] placeholder:text-[#3d4a5c]"
                    name="name"
                    placeholder="Nama User"
                    value="<%= editUser.name %>"
                    required
                />
                <input
                    class="bg-[#141720] border border-border rounded-sm py-2.5 px-4 text-[#e8edf5] font-rajdhani text-[0.95rem] font-medium w-full outline-none transition-colors focus:border-purple-bright focus:shadow-[0_0_0_2px_rgba(167,139,250,0.08)] placeholder:text-[#3d4a5c]"
                    name="chix"
                    type="number"
                    placeholder="CHIX"
                    value="<%= editUser.chix %>"
                    required
                />
                <input
                    class="bg-[#141720] border border-border rounded-sm py-2.5 px-4 text-[#e8edf5] font-rajdhani text-[0.95rem] font-medium w-full outline-none transition-colors focus:border-purple-bright focus:shadow-[0_0_0_2px_rgba(167,139,250,0.08)] placeholder:text-[#3d4a5c]"
                    name="storage_cap"
                    type="number"
                    placeholder="Storage Capacity"
                    value="<%= editUser.storage_cap %>"
                    required
                />
                <input
                    class="bg-[#141720] border border-border rounded-sm py-2.5 px-4 text-[#e8edf5] font-rajdhani text-[0.95rem] font-medium w-full outline-none transition-colors focus:border-purple-bright focus:shadow-[0_0_0_2px_rgba(167,139,250,0.08)] placeholder:text-[#3d4a5c]"
                    name="level"
                    type="number"
                    placeholder="Level"
                    value="<%= editUser.level %>"
                    required
                />
                <input
                    class="bg-[#141720] border border-border rounded-sm py-2.5 px-4 text-[#e8edf5] font-rajdhani text-[0.95rem] font-medium w-full outline-none transition-colors focus:border-purple-bright focus:shadow-[0_0_0_2px_rgba(167,139,250,0.08)] placeholder:text-[#3d4a5c]"
                    name="idle_speed_level"
                    type="number"
                    placeholder="Idle Speed Level"
                    value="<%= editUser.idle_speed_level %>"
                    required
                />
                <input
                    class="bg-[#141720] border border-border rounded-sm py-2.5 px-4 text-[#e8edf5] font-rajdhani text-[0.95rem] font-medium w-full outline-none transition-colors focus:border-purple-bright focus:shadow-[0_0_0_2px_rgba(167,139,250,0.08)] placeholder:text-[#3d4a5c]"
                    name="idle_speed_multiplier"
                    type="number"
                    step="0.1"
                    placeholder="Idle Speed Multiplier"
                    value="<%= editUser.idle_speed_multiplier %>"
                    required
                />

                <div class="col-span-full flex gap-3 items-center max-sm:col-span-1">
                    <button
                        type="submit"
                        class="bg-purple-bright text-[#0a0c10] border-none py-2.5 px-6 rounded-sm font-rajdhani font-bold text-[0.95rem] tracking-[0.08em] uppercase cursor-pointer transition-all hover:bg-[#c4b5fd] hover:-translate-y-px"
                    >
                        Update
                    </button>
                    <a
                        href="/users"
                        class="bg-transparent border border-border text-text-muted py-2.5 px-5 rounded-sm font-rajdhani text-[0.95rem] no-underline tracking-[0.05em] transition-colors hover:border-text-muted hover:text-secondary"
                    >
                        Batal
                    </a>
                </div>
            </div>
        </form>
    </div>
    <% } %>

    <div
        class="inline-flex items-center gap-2 text-[0.7rem] font-techmono tracking-widest text-purple-brifrom-purple-bright bg-[rgba(167,139,250,0.08)] border border-[rgba(167,139,250,0.2)] py-1 px-3 rounded-sm w-fit mb-6"
    >
        ◈ REGISTERED USERS
    </div>

    <div class="grid grid-cols-[repeat(auto-fill,minmax(280px,1fr))] gap-4">
        <% if (!users || users.length === 0) { %>
        <div class="col-span-full text-center py-16 px-5 font-techmono text-xs text-text-darker tracking-widest">
            // NO_USERS · belum ada pengguna terdaftar
        </div>
        <% } else { %>
        <% users.forEach(item => { %>
        <div
            class="bg-[#0f1117] border border-border rounded px-6 py-5 relative overflow-hidden transition-all duration-200 cursor-default hover:border-purple-brifrom-purple-bright hover:-translate-y-0.5 before:content-[''] before:absolute before:top-0 before:left-0 before:right-0 before:h-0.5 before:bg-linear-to-r before:from-purple-bright before:via-pink-bright before:to-transparent before:opacity-0 before:transition-opacity before:duration-200 hover:before:opacity-100"
        >
            <div
                class="w-10.5 h-10.5 rounded-full bg-linear-to-br from-purple-bright to-pink-bright flex items-center justify-center text-xl font-bold text-[#0a0c10] mb-4 font-rajdhani tracking-[0.05em]"
            >
                <%= item.name ? item.name.charAt(0).toUpperCase() : '?' %>
            </div>
            <h2 class="text-lg font-bold text-[#e8edf5] tracking-[0.06em] mb-1.5 m-0 uppercase"><%= item.name %></h2>
            <div class="space-y-0.5 mb-4">
                <p class="text-[0.78rem] text-text-muted leading-relaxed m-0 font-techmono tracking-[0.02em]">
                    CHIX: <span class="text-lime-bright"><%= item.chix || 0 %></span>
                </p>
                <p class="text-[0.78rem] text-text-muted leading-relaxed m-0 font-techmono tracking-[0.02em]">
                    Storage: <span class="text-cyan-bright"><%= item.storage_cap || 100 %></span>
                </p>
                <p class="text-[0.78rem] text-text-muted leading-relaxed m-0 font-techmono tracking-[0.02em]">
                    Level: <span class="text-amber-bright"><%= item.level || 1 %></span>
                </p>
                <p class="text-[0.78rem] text-text-muted leading-relaxed m-0 font-techmono tracking-[0.02em]">
                    Idle Speed:
                    <span class="text-purple-brifrom-purple-bright">x<%= item.idle_speed_multiplier || 1 %></span>
                </p>
            </div>
            <a
                href="/users/<%= item.id %>/edit"
                class="inline-block py-1 px-3 rounded-xs bg-[rgba(167,139,250,0.12)] border border-[rgba(167,139,250,0.28)] text-purple-brifrom-purple-bright text-[0.78rem] font-techmono no-underline transition-colors hover:bg-[rgba(167,139,250,0.22)]"
            >
                Edit
            </a>
        </div>
        <% }); %>
        <% } %>
    </div>
</section>
